"use strict";(self["webpackChunkvue2_shopping"]=self["webpackChunkvue2_shopping"]||[]).push([[795],{632:function(t,s,a){a.d(s,{A:function(){return r}});var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"count-box"},[s("button",{staticClass:"minus",on:{click:t.handleSub}},[t._v("-")]),s("input",{staticClass:"inp",attrs:{type:"text"},domProps:{value:t.value},on:{change:t.handleChange}}),s("button",{staticClass:"add",on:{click:t.handleAdd}},[t._v("+")])])},e=[],n={props:{value:{type:Number,default:1}},methods:{handleSub(){this.value<=1||this.$emit("input",this.value-1)},handleAdd(){this.$emit("input",this.value+1)},handleChange(t){const s=+t.target.value;isNaN(s)||s<1?t.target.value=this.value:this.$emit("input",s)}}},o=n,c=a(1656),l=(0,c.A)(o,i,e,!1,null,"69a70c72",null),r=l.exports},2795:function(t,s,a){a.r(s),a.d(s,{default:function(){return C}});a(4114);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"prodetail"},[s("van-nav-bar",{attrs:{fixed:"",title:"商品详情页","left-arrow":""},on:{"click-left":function(s){return t.$router.go(-1)}}}),s("van-swipe",{attrs:{autoplay:3e3},on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[s("div",{staticClass:"custom-indicator"},[t._v(" "+t._s(t.current+1)+" / "+t._s(t.images.length)+" ")])]},proxy:!0}])},t._l(t.images,(function(t,a){return s("van-swipe-item",{key:a},[s("img",{attrs:{src:t.external_url}})])})),1),s("div",{staticClass:"info"},[s("div",{staticClass:"title"},[s("div",{staticClass:"price"},[s("span",{staticClass:"now"},[t._v("￥"+t._s(t.detail.goods_price_min))]),s("span",{staticClass:"oldprice"},[t._v("￥"+t._s(t.detail.line_price_max))])]),s("div",{staticClass:"sellcount"},[t._v("已售"+t._s(t.detail.goods_sales)+"件")])]),s("div",{staticClass:"msg text-ellipsis-2"},[t._v(" "+t._s(t.detail.goods_name)+" ")]),s("div",{staticClass:"service",on:{click:function(s){t.show=!0}}},[s("div",{staticClass:"left-words"},t._l(t.serviceList,(function(a,i){return s("span",{key:i},[s("van-icon",{attrs:{name:"passed"}}),t._v(t._s(a.name))],1)})),0),s("div",{staticClass:"right-icon"},[s("van-icon",{attrs:{name:"arrow"}})],1)]),s("van-action-sheet",{attrs:{title:"服务"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[s("div",{staticClass:"service-content"},t._l(t.serviceList,(function(a,i){return s("div",{key:i,staticClass:"service-item"},[s("div",{staticClass:"service-title"},[s("van-icon",{attrs:{name:"passed"}}),s("span",[t._v(t._s(a.name))])],1),s("div",{staticClass:"content"},[t._v(t._s(a.summary))])])})),0)])],1),s("div",{staticClass:"comment"},[s("div",{staticClass:"comment-title"},[s("div",{staticClass:"left"},[t._v("商品评价 ("+t._s(this.TotalComments)+"条)")]),s("div",{staticClass:"right",on:{click:function(s){return t.$router.push(`/comments?goodsId=${t.goodsId}`)}}},[t._v("查看更多 "),s("van-icon",{attrs:{name:"arrow"}})],1)]),s("div",{staticClass:"comment-list"},t._l(t.CommentsList,(function(a){return s("div",{key:a.comment_id,staticClass:"comment-item"},[s("div",{staticClass:"top"},[s("img",{attrs:{src:a.user.avatar_url||t.defaultImg,alt:""}}),s("div",{staticClass:"name"},[t._v(t._s(a.user.nick_name))]),s("van-rate",{attrs:{size:16,value:5,color:"#ffd21e","void-icon":"star","void-color":"#eee"}})],1),s("div",{staticClass:"content"},[t._v(" "+t._s(a.content)+" ")]),s("div",{staticClass:"time"},[t._v(" "+t._s(a.create_time)+" ")])])})),0)]),s("div",{staticClass:"desc",domProps:{innerHTML:t._s(t.detail.content)}}),s("div",{staticClass:"footer"},[s("div",{staticClass:"icon-home",on:{click:function(s){return t.$router.push("/home")}}},[s("van-icon",{attrs:{name:"wap-home-o"}}),s("span",[t._v("首页")])],1),s("div",{staticClass:"icon-cart",on:{click:function(s){return t.$router.push("/cart")}}},[s("van-icon",{attrs:{name:"shopping-cart-o",badge:t.cartTotal>0?t.cartTotal:""}}),s("span",[t._v("购物车")])],1),s("div",{staticClass:"btn-add",on:{click:t.add}},[t._v("加入购物车")]),s("div",{staticClass:"btn-buy",on:{click:t.buy}},[t._v("立刻购买")])]),s("van-action-sheet",{attrs:{title:"cart"===t.mode?"加入购物车":"立刻购买"},model:{value:t.showPannel,callback:function(s){t.showPannel=s},expression:"showPannel"}},[s("div",{staticClass:"product"},[s("div",{staticClass:"product-title"},[s("div",{staticClass:"left"},[s("img",{attrs:{src:t.detail.goods_image,alt:""}})]),s("div",{staticClass:"right"},[s("div",{staticClass:"price"},[s("span",[t._v("¥")]),s("span",{staticClass:"nowprice"},[t._v(t._s(t.detail.goods_price_min))])]),s("div",{staticClass:"count"},[s("span",[t._v("库存")]),s("span",[t._v(t._s(t.detail.stock_total))])])])]),s("div",{staticClass:"num-box"},[s("span",[t._v("数量")]),s("CountBox",{model:{value:t.count,callback:function(s){t.count=s},expression:"count"}})],1),t.detail.stock_total>0?s("div",{staticClass:"showbtn"},["cart"===t.mode?s("div",{staticClass:"btn",on:{click:t.addCart}},[t._v("加入购物车")]):s("div",{staticClass:"btn now",on:{click:t.goPay}},[t._v("立刻购买")])]):s("div",{staticClass:"btn-none"},[t._v("该商品已抢完")])])])],1)},e=[],n=a(8484),o=a(9652),c=a(4194),l=a(632),r=a(7767),d=a(7167),u={name:"ProDetail",mixins:[d.A],data(){return{images:[],detail:{},current:0,TotalComments:0,CommentsList:[],defaultImg:r,show:!1,serviceList:[],mode:"cart",showPannel:!1,count:1,cartTotal:0}},components:{CountBox:l.A},computed:{goodsId(){return this.$route.params.id},token(){return this.$store.getters.token}},created(){this.token&&this.getCartTotal(),this.getGoodsDetail(),this.getComments(),this.getGoodsService()},methods:{onChange(t){this.current=t},async getCartTotal(){const{data:{cartTotal:t}}=await(0,o.Tj)();this.cartTotal=t},async getGoodsDetail(){const{data:{detail:t}}=await(0,c._P)(this.goodsId);this.detail=t,this.images=t.goods_images},async getComments(){const{data:{list:t,total:s}}=await(0,n.v)(this.goodsId);this.CommentsList=t,this.TotalComments=s},async getGoodsService(){const{data:{list:t}}=await(0,c.As)(this.goodsId);this.serviceList=t},add(){this.mode="cart",this.showPannel=!0},buy(){this.mode="buyNow",this.showPannel=!0},async addCart(){if(this.loginConfirm())return;const{message:t,data:{cartTotal:s}}=await(0,o.U4)(this.detail.goods_id,this.count,this.detail.skuList[0].goods_sku_id);this.$toast(t),this.cartTotal=s,this.showPannel=!1},goPay(){this.loginConfirm()||this.$router.push({path:"/pay",query:{mode:"buyNow",goodsId:this.goodsId,goodsSkuId:this.detail.skuList[0].goods_sku_id,goodsNum:this.count}})}}},v=u,m=a(1656),h=(0,m.A)(v,i,e,!1,null,"26be641d",null),C=h.exports},8484:function(t,s,a){a.d(s,{S:function(){return n},v:function(){return e}});var i=a(5720);const e=(t,s)=>i.A.get("/comment/listRows",{params:{goodsId:t,limit:3}}),n=(t,s,a)=>i.A.get("/comment/list",{params:{scoreType:t,goodsId:s,page:a}})},4194:function(t,s,a){a.d(s,{As:function(){return o},F5:function(){return e},_P:function(){return n}});var i=a(5720);const e=t=>i.A.get("/goods/list",{params:{...t}}),n=t=>i.A.get("/goods/detail",{params:{goodsId:t}}),o=t=>i.A.get("/goods.service/list",{params:{goodsId:t}})},7167:function(t,s){s.A={methods:{loginConfirm(){return!this.$store.getters.token&&(this.$dialog.confirm({title:"温馨提示",message:"还没登录呢蠢货",confirmButtonText:"去登陆",cancelButtonText:"再逛逛"}).then((()=>{this.$router.replace({path:"/login",query:{backUrl:this.$route.fullPath}})})).catch((()=>{})),!0)}}}},7767:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkBAMAAACCzIhnAAAAKlBMVEXp6en////9/f3o6Ojw8PDj4+Pl5eXh4eHs7Oz7+/v09PTy8vL4+Pj29vY+GdZKAAADDElEQVRYw+3Wv0sbYRjA8ZNwp+Li89YhUQO+b6F0PDTx6NBBtHXpcBDPRkvhakiC1CGghqIIyRCdOqQlHdouUoqlm1Co0KUZhK4tFPvn9MnF5n6+P4R2KT6EhJe8n3y5ewOJduXJXZNr8l+Tecd5uFu6CinbS18+LR06pjJxxl4ATuZD2anMaXMKxHkOl/P6LFVxCnJi3YXAvP34zZWR1A6E54aUVI8j5J4mIcZBRExLr8WKRk5cGdmHyFyYEqI3o2SqJiH5NkRHl5B9iE3HFBJjI07StpDoC3Ey7QrJfBviYwiJCwmzLCQ7SeRCSNaTyEtTQFKbSSTtishsIrEFxBi6Jn+FFAWk+iSR1PnEyHWTSObM5pJSG5KnxSWPgDMdk0ce88gMl6zzyE0uWRnsoWFyziUubiWMAiMM8AmdtwT4zL38fJcxRnAXw6EI+0sGBpfoTUJIbxfF6ZnL5aTNP/0DklSht1w+KVFK4xVY1vjkqEkSKtltAdH2IF6Bjisi1vd4BfSGiByukWiFjtvi35dKO1qBI01M8AZEKtmahKQ2wxVK07aEaCuRCj3XZKTSDl8L6FIyPESCFZisSYm2F76Wjisn5TZlgYrekJPWLPErdKKm8kfxGfgVODFVyHATBpXJbU2FpDYGdwzGi2rkzqBC064a2fIrSP5VZTZQsZVIa8i/Y1M1JTJ86p9LZrWhdpSB01c6SqtJ/ApM1RtSYmDErzB4b0uJc0qYXyEsUzUlpDoKNFgh9LZjCkn1KTAWqhD4umvyScrJUULDFTTvsMMhxu4YimiFUfhVLSSTvPsAUMQqhMKbw0ICGckXf3giVsEHZO6vxsiIVewC7kqsUAZksR4lerENjPAquCCLhTAxtrv4Lr+CT6Rlh4hzCpSKKozQrGUGiDUKjIkrjMBEvTEg+FXsfyJWiLfRm96LV+unGPy0B6R83NuI73qAeKq/9h4epjgZ6w/Rt8Db2EeBCq4DFdQztUuy2mWKA0d9oq8RVULTNY+UMaKcyfdIao+oE/rKRqIvsCtMtpT7DVEPKD7Ga13IAAAAAElFTkSuQmCC"}}]);
//# sourceMappingURL=795.f393c295.js.map